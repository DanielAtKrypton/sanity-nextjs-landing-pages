language: node_js
node_js:
- '12'
install:
- npm ci
script:
- npm test
after_success:
- source ./scripts/create_all_branches.sh
- create_all_branches
- git checkout master
- find -maxdepth 1 -name node_modules -type d | xargs sudo rm -rf
- find -maxdepth 2 -name node_modules -type d | xargs sudo rm -rf
- find -maxdepth 3 -name node_modules -type d | xargs sudo rm -rf
- find ! -regex '^./build\(/.*\)?' -a ! -regex '^./.git\(/.*\)?' -a ! -regex '.' |
  xargs sudo rm -rf
- sleep 5
- sudo mv ./build/.* ./build/* .
- sudo rm build -r
- git config credential.helper "store --file=.git/credentials"
- echo "https://${GH_TOKEN}:@github.com" > .git/credentials
after_script:
- setup_git_user
- git add .
- git commit -m "Push from development branch at Travis"
- git push origin master
env:
  global:
    secure: UzLTOog0Jjdgxbq9pWUzumDfSWhaqQqj3pp+HQcJPI5mnt+PjDyXiKvCpyYi3A9qvM/kUUwUhTUwJhAjcC2iOFmtiySf1jsj/WIK2PhQa+vKNp4BlfFk0hZUFzspUrEYi0moAvWwVfPSYgzbjK+l8ZNsoxXO9JjOdCnOLSF3WnTKAY4l5Qd8+eR0prpKQLxEfBZ8nDskm7I43bPxhDeAPqih+D8DUBy4mZPqdDjv2Y0ukh3rvXlJTruxyHoQn+oe14naL3bOmFftAAmtzL/MUHaEAOjPA5MNLPPpg4yIFbIyMwGN601rQ7oHNnYPUNgEEk0+40VD9AfWHu7wBbZOWzW+YlC4bbW1o0tkxHKWlawoq91NqdM0icEpVYPvjwA7AachagE1fmzoCzIxbEL4dUSN+KJMJsW+VXeJhWl/roRQ8sMv2xrQjVfc9CzVW5XzwfEPIZevwhT3hvlEzjhcAZ0gz2/PtlDu8r77XlMStoPYBYzcs6YvO4o0AUQU0f6AJr+6VTrZdjLufZ0im1s9vndVfORCxlkxbMe6mbIAO2BiQuXgZh1U0ZaRK7BIHT5F3sHbwsJm1xMqYLndBipWMm3q/eQ4IFdUR49IYciOyslD92NzOEPoY11Zul/9EpXlqcUOkBIXjtpeZbziEXBwYi6Q3O3joR62hrf7h1xhUW8=
